{% extends 'base.html' %}
{% block content %}

<h1>求人一覧</h1>
<div id="job-list" class="small">求人情報を読み込んでいます...</div>

<script>
(function() {
  const jobListArea = document.getElementById('job-list');

  // ページの読み込み時に /api/jobs から求人データを取得
  fetch('/api/jobs')
    .then(response => response.json())
    .then(jobs => {
      if (!jobs || jobs.length === 0) {
        jobListArea.textContent = '現在、求人はありません。';
        return;
      }
      
      // 取得した求人データを元にカードを作成
      let html = '<div style="display: flex; flex-direction: column; gap: 16px;">';
      jobs.forEach(job => {
        html += `<div class="card">
          <h2>${job.title || ''} <span class="badge">${job.sector || ''}</span></h2>
          <div class="small" style="margin-bottom: 12px;">${job.company || ''} - ${job.location || ''}</div>
          <div><b>必須スキル・経験:</b></div>
          <div class="small" style="margin-bottom: 12px;">${(job.required_skills || []).join(', ')}</div>
          <div><b>必須資格:</b></div>
          <div class="small" style="margin-bottom: 12px;">${(job.required_qualifications || []).join(', ')}</div>
          <div><b>必須経験年数:</b> ${job.experience_years || 0}年</div>
        </div>`;
      });
      html += '</div>';

      jobListArea.innerHTML = html;
    })
    .catch(error => {
      console.error('求人情報の読み込みに失敗しました:', error);
      jobListArea.textContent = '求人情報の読み込み中にエラーが発生しました。';
    });
})();
</script>

{% endblock %}